<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Dodaj i przeglƒÖdaj pracownik√≥w</title>
  <link rel="stylesheet" href="frontend/style.css">
  <style>
    table {
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 6px 12px;
    }
  </style>
</head>
<body>
  <h2>Dodaj nowego pracownika</h2>
  <form id="employeeForm">
    <label>Numer (ID):</label><br>
    <input type="text" id="id" required><br><br>

    <label>Imiƒô i nazwisko:</label><br>
    <input type="text" id="name" required><br><br>

    <label>Stawka godzinowa (PLN):</label><br>
    <input type="number" id="rate" step="0.01" required><br><br>

    <button type="submit">Dodaj</button>
  </form>

  <p id="result"></p>

  <h2>Lista pracownik√≥w</h2>
  <button onclick="loadEmployees()">üîÑ Od≈õwie≈º</button>
  <table id="employeeTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>Imiƒô i nazwisko</th>
        <th>Stawka (z≈Ç/h)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    document.getElementById("employeeForm").addEventListener("submit", async function(event) {
      event.preventDefault();

      const id = document.getElementById("id").value;
      const name = document.getElementById("name").value;
      const rate = parseFloat(document.getElementById("rate").value);

      const response = await fetch("http://127.0.0.1:8000/employees", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          id: id,
          name: name,
          hourly_rate: rate
        })
      });

      const result = document.getElementById("result");
      if (response.ok) {
        const data = await response.json();
        result.innerText = `‚úÖ Dodano pracownika: ${data.name} (${data.id})`;
        loadEmployees(); // automatycznie od≈õwie≈º listƒô
      } else {
        const error = await response.text();
        result.innerText = "‚ùå B≈ÇƒÖd: " + error;
      }
    });

    async function loadEmployees() {
      const response = await fetch("http://127.0.0.1:8000/employees");
      const table = document.querySelector("#employeeTable tbody");
      table.innerHTML = "";

      if (response.ok) {
        const employees = await response.json();
        for (const emp of employees) {
          const row = `<tr>
            <td>${emp.id}</td>
            <td>${emp.name}</td>
            <td>${emp.hourly_rate}</td>
          </tr>`;
          table.innerHTML += row;
        }
      } else {
        table.innerHTML = "<tr><td colspan='3'>B≈ÇƒÖd pobierania danych</td></tr>";
      }
    }

    // automatycznie za≈Çaduj listƒô na start
    loadEmployees();
  </script>
</body>
</html>
