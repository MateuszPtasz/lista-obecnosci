<!-- KOMPONENT EWIDENCJI OBECNO≈öCI -->
<div class="obecnosc-komponent" id="obecnosc-komponent">
    <div class="naglowek-obecnosci">
        <h1><i class="fas fa-calendar-check"></i> Ewidencja Obecno≈õci</h1>
        <p>ZarzƒÖdzanie obecno≈õciƒÖ pracownik√≥w w systemie</p>
    </div>

    <div class="tresc-obecnosci">
        <!-- Panel kontroli -->
        <div class="panel-kontroli">
            <div class="kontrola-grupa">
                <h3><i class="fas fa-filter"></i> Filtry</h3>
                <div class="filtry-siatka">
                    <div class="filtr-grupa">
                        <label for="filtr-data-od">Data Od:</label>
                        <input type="date" id="filtr-data-od" name="dataOd">
                    </div>
                    
                    <div class="filtr-grupa">
                        <label for="filtr-data-do">Data Do:</label>
                        <input type="date" id="filtr-data-do" name="dataDo">
                    </div>
                    
                    <div class="filtr-grupa">
                        <label for="filtr-dzial">Dzia≈Ç:</label>
                        <select id="filtr-dzial" name="dzial">
                            <option value="">-- Wszystkie dzia≈Çy --</option>
                            <option value="administracja">üè¢ Administracja</option>
                            <option value="it">üíª Informatyka (IT)</option>
                            <option value="marketing">üìà Marketing i Sprzeda≈º</option>
                            <option value="hr">üë• Zasoby Ludzkie (HR)</option>
                            <option value="finanse">üí∞ Finanse i Ksiƒôgowo≈õƒá</option>
                            <option value="produkcja">üè≠ Produkcja</option>
                            <option value="logistyka">üöö Logistyka</option>
                        </select>
                    </div>
                    
                    <div class="filtr-grupa">
                        <label for="filtr-status">Status:</label>
                        <select id="filtr-status" name="status">
                            <option value="">-- Wszystkie statusy --</option>
                            <option value="obecny">üü¢ Obecny</option>
                            <option value="nieobecny">üî¥ Nieobecny</option>
                            <option value="spoznienie">üü° Sp√≥≈∫nienie</option>
                            <option value="urlop">üèñÔ∏è Urlop</option>
                            <option value="choroba">üè• L4</option>
                            <option value="delegacja">‚úàÔ∏è Delegacja</option>
                        </select>
                    </div>
                </div>
                
                <div class="akcje-filtrow">
                    <button type="button" class="btn-filtruj" id="zastosuj-filtry">
                        <i class="fas fa-search"></i> Filtruj
                    </button>
                    <button type="button" class="btn-wyczysc" id="wyczysc-filtry">
                        <i class="fas fa-undo"></i> Wyczy≈õƒá
                    </button>
                    <button type="button" class="btn-eksport" id="eksport-danych">
                        <i class="fas fa-download"></i> Eksport CSV
                    </button>
                </div>
            </div>
        </div>

        <!-- Statystyki og√≥lne -->
        <div class="panel-statystyk">
            <div class="statystyka-karta">
                <div class="statystyka-ikona obecni">
                    <i class="fas fa-user-check"></i>
                </div>
                <div class="statystyka-dane">
                    <h3 id="liczba-obecnych">0</h3>
                    <p>Obecnych Dzisiaj</p>
                </div>
            </div>
            
            <div class="statystyka-karta">
                <div class="statystyka-ikona nieobecni">
                    <i class="fas fa-user-times"></i>
                </div>
                <div class="statystyka-dane">
                    <h3 id="liczba-nieobecnych">0</h3>
                    <p>Nieobecnych</p>
                </div>
            </div>
            
            <div class="statystyka-karta">
                <div class="statystyka-ikona spoznienia">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="statystyka-dane">
                    <h3 id="liczba-spoznien">0</h3>
                    <p>Sp√≥≈∫nie≈Ñ</p>
                </div>
            </div>
            
            <div class="statystyka-karta">
                <div class="statystyka-ikona urlopow">
                    <i class="fas fa-umbrella-beach"></i>
                </div>
                <div class="statystyka-dane">
                    <h3 id="liczba-urlopow">0</h3>
                    <p>Na Urlopie</p>
                </div>
            </div>
        </div>

        <!-- Tabela obecno≈õci -->
        <div class="tabela-obecnosci-kontener">
            <div class="tabela-naglowek">
                <h3><i class="fas fa-table"></i> Lista Obecno≈õci</h3>
                <div class="tabela-akcje">
                    <button type="button" class="btn-odswiezenie" id="odswiez-tabele">
                        <i class="fas fa-sync-alt"></i> Od≈õwie≈º
                    </button>
                    <button type="button" class="btn-dodaj" id="dodaj-wpis">
                        <i class="fas fa-plus"></i> Dodaj Wpis
                    </button>
                </div>
            </div>
            
            <div class="tabela-wrapper">
                <table class="tabela-obecnosci" id="tabela-obecnosci">
                    <thead>
                        <tr>
                            <th><i class="fas fa-hashtag"></i> ID</th>
                            <th><i class="fas fa-user"></i> Pracownik</th>
                            <th><i class="fas fa-building"></i> Dzia≈Ç</th>
                            <th><i class="fas fa-calendar"></i> Data</th>
                            <th><i class="fas fa-clock"></i> Rozpoczƒôcie</th>
                            <th><i class="fas fa-clock"></i> Zako≈Ñczenie</th>
                            <th><i class="fas fa-hourglass"></i> Czas Pracy</th>
                            <th><i class="fas fa-info-circle"></i> Status</th>
                            <th><i class="fas fa-comment"></i> Uwagi</th>
                            <th><i class="fas fa-cogs"></i> Akcje</th>
                        </tr>
                    </thead>
                    <tbody id="tabela-obecnosci-body">
                        <!-- Dane bƒôdƒÖ ≈Çadowane przez JavaScript -->
                        <tr class="ladowanie-wiersz">
                            <td colspan="10">
                                <div class="ladowanie-animation">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    ≈Åadowanie danych obecno≈õci...
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Paginacja -->
        <div class="paginacja-kontener" id="paginacja-kontener">
            <div class="paginacja-info">
                <span>Wynik√≥w na stronie: </span>
                <select id="wynikow-na-strone">
                    <option value="10">10</option>
                    <option value="25" selected>25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
                <span id="paginacja-info-tekst">Pokazano 1-25 z 0 wynik√≥w</span>
            </div>
            
            <div class="paginacja-przyciski">
                <button class="btn-paginacja" id="pierwsza-strona" disabled>
                    <i class="fas fa-angle-double-left"></i>
                </button>
                <button class="btn-paginacja" id="poprzednia-strona" disabled>
                    <i class="fas fa-angle-left"></i>
                </button>
                <span class="paginacja-numery" id="paginacja-numery">
                    <!-- Numery stron bƒôdƒÖ generowane przez JavaScript -->
                </span>
                <button class="btn-paginacja" id="nastepna-strona" disabled>
                    <i class="fas fa-angle-right"></i>
                </button>
                <button class="btn-paginacja" id="ostatnia-strona" disabled>
                    <i class="fas fa-angle-double-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal dodawania/edycji wpisu -->
    <div class="modal-overlay" id="modal-wpisu" style="display: none;">
        <div class="modal-kontener">
            <div class="modal-naglowek">
                <h3><i class="fas fa-edit"></i> <span id="modal-tytul">Dodaj Wpis Obecno≈õci</span></h3>
                <button class="btn-zamknij-modal" id="zamknij-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-tresc">
                <form id="formularz-wpisu">
                    <div class="modal-siatka">
                        <div class="grupa-pola">
                            <label for="modal-pracownik">Pracownik *</label>
                            <select id="modal-pracownik" name="pracownik" required>
                                <option value="">-- Wybierz pracownika --</option>
                                <!-- Opcje bƒôdƒÖ ≈Çadowane przez JavaScript -->
                            </select>
                        </div>
                        
                        <div class="grupa-pola">
                            <label for="modal-data">Data *</label>
                            <input type="date" id="modal-data" name="data" required>
                        </div>
                        
                        <div class="grupa-pola">
                            <label for="modal-rozpoczecie">Rozpoczƒôcie</label>
                            <input type="time" id="modal-rozpoczecie" name="rozpoczecie">
                        </div>
                        
                        <div class="grupa-pola">
                            <label for="modal-zakonczenie">Zako≈Ñczenie</label>
                            <input type="time" id="modal-zakonczenie" name="zakonczenie">
                        </div>
                        
                        <div class="grupa-pola">
                            <label for="modal-status">Status *</label>
                            <select id="modal-status" name="status" required>
                                <option value="obecny">üü¢ Obecny</option>
                                <option value="nieobecny">üî¥ Nieobecny</option>
                                <option value="spoznienie">üü° Sp√≥≈∫nienie</option>
                                <option value="urlop">üèñÔ∏è Urlop</option>
                                <option value="choroba">üè• L4</option>
                                <option value="delegacja">‚úàÔ∏è Delegacja</option>
                            </select>
                        </div>
                        
                        <div class="grupa-pola pe≈Çna-szeroko≈õƒá">
                            <label for="modal-uwagi">Uwagi</label>
                            <textarea id="modal-uwagi" name="uwagi" rows="3" 
                                     placeholder="Dodatkowe informacje dotyczƒÖce obecno≈õci..."></textarea>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="modal-stopka">
                <button type="button" class="btn-drugorzedny" id="anuluj-modal">
                    <i class="fas fa-times"></i> Anuluj
                </button>
                <button type="button" class="btn-g≈Ç√≥wny" id="zapisz-wpis">
                    <i class="fas fa-save"></i> Zapisz Wpis
                </button>
            </div>
        </div>
    </div>
</div>

<style>
/* STYLE KOMPONENTU EWIDENCJI OBECNO≈öCI */
.obecnosc-komponent {
    font-family: 'Segoe UI', 'Arial', sans-serif;
    padding: 20px;
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    min-height: 100vh;
    line-height: 1.6;
}

/* Nag≈Ç√≥wek */
.naglowek-obecnosci {
    text-align: center;
    margin-bottom: 40px;
    padding: 40px 30px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 20px;
    box-shadow: 0 15px 35px rgba(102, 126, 234, 0.3);
}

.naglowek-obecnosci h1 {
    font-size: 2.3rem;
    margin: 0 0 15px 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.naglowek-obecnosci p {
    font-size: 1.1rem;
    margin: 0;
    opacity: 0.95;
}

/* Panel kontroli */
.panel-kontroli {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    padding: 30px;
    border-radius: 16px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    margin-bottom: 30px;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.kontrola-grupa h3 {
    color: #2c3e50;
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.filtry-siatka {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
    margin-bottom: 25px;
}

.filtr-grupa label {
    display: block;
    margin-bottom: 8px;
    color: #2c3e50;
    font-weight: 600;
    font-size: 14px;
}

.filtr-grupa input,
.filtr-grupa select {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #e9ecef;
    border-radius: 10px;
    font-size: 14px;
    transition: all 0.3s ease;
    background: rgba(255, 255, 255, 0.9);
    box-sizing: border-box;
}

.filtr-grupa input:focus,
.filtr-grupa select:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    transform: translateY(-1px);
}

.akcje-filtrow {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
}

.btn-filtruj {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.btn-filtruj:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
}

.btn-wyczysc {
    background: rgba(108, 117, 125, 0.1);
    color: #6c757d;
    border: 2px solid rgba(108, 117, 125, 0.2);
    padding: 12px 24px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.btn-wyczysc:hover {
    background: rgba(108, 117, 125, 0.15);
    transform: translateY(-1px);
}

.btn-eksport {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
}

.btn-eksport:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(40, 167, 69, 0.4);
}

/* Panel statystyk */
.panel-statystyk {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.statystyka-karta {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    padding: 25px;
    border-radius: 16px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    gap: 20px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
}

.statystyka-karta:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(0,0,0,0.15);
}

.statystyka-ikona {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: white;
}

.statystyka-ikona.obecni {
    background: linear-gradient(135deg, #28a745, #20c997);
}

.statystyka-ikona.nieobecni {
    background: linear-gradient(135deg, #dc3545, #c82333);
}

.statystyka-ikona.spoznienia {
    background: linear-gradient(135deg, #ffc107, #fd7e14);
}

.statystyka-ikona.urlopow {
    background: linear-gradient(135deg, #17a2b8, #138496);
}

.statystyka-dane h3 {
    font-size: 2rem;
    font-weight: 700;
    margin: 0 0 5px 0;
    color: #2c3e50;
}

.statystyka-dane p {
    font-size: 14px;
    color: #6c757d;
    margin: 0;
    font-weight: 500;
}

/* Tabela obecno≈õci */
.tabela-obecnosci-kontener {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 16px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.tabela-naglowek {
    padding: 25px 30px;
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    border-bottom: 2px solid #e9ecef;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 15px;
}

.tabela-naglowek h3 {
    margin: 0;
    color: #2c3e50;
    font-size: 18px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 10px;
}

.tabela-akcje {
    display: flex;
    gap: 10px;
}

.btn-odswiezenie,
.btn-dodaj {
    padding: 10px 20px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    border: none;
}

.btn-odswiezenie {
    background: rgba(102, 126, 234, 0.1);
    color: #667eea;
    border: 2px solid rgba(102, 126, 234, 0.2);
}

.btn-odswiezenie:hover {
    background: rgba(102, 126, 234, 0.15);
    transform: translateY(-1px);
}

.btn-dodaj {
    background: linear-gradient(135deg, #28a745, #20c997);
    color: white;
    box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
}

.btn-dodaj:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(40, 167, 69, 0.4);
}

.tabela-wrapper {
    overflow-x: auto;
    max-height: 600px;
    overflow-y: auto;
}

.tabela-obecnosci {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
}

.tabela-obecnosci th {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    padding: 15px 12px;
    text-align: left;
    font-weight: 600;
    position: sticky;
    top: 0;
    z-index: 10;
}

.tabela-obecnosci th i {
    margin-right: 5px;
    font-size: 12px;
}

.tabela-obecnosci td {
    padding: 12px;
    border-bottom: 1px solid #e9ecef;
    vertical-align: middle;
}

.tabela-obecnosci tbody tr:hover {
    background: rgba(102, 126, 234, 0.05);
}

.ladowanie-animation {
    text-align: center;
    padding: 40px;
    color: #6c757d;
    font-size: 16px;
}

.ladowanie-animation i {
    margin-right: 10px;
    color: #667eea;
}

/* Status badges */
.status-badge {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 5px;
}

.status-obecny { background: rgba(40, 167, 69, 0.1); color: #28a745; }
.status-nieobecny { background: rgba(220, 53, 69, 0.1); color: #dc3545; }
.status-spoznienie { background: rgba(255, 193, 7, 0.1); color: #ffc107; }
.status-urlop { background: rgba(23, 162, 184, 0.1); color: #17a2b8; }
.status-choroba { background: rgba(255, 87, 34, 0.1); color: #ff5722; }
.status-delegacja { background: rgba(156, 39, 176, 0.1); color: #9c27b0; }

/* Paginacja */
.paginacja-kontener {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 20px;
    padding: 20px 30px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 16px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
}

.paginacja-info {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
    color: #6c757d;
}

.paginacja-info select {
    padding: 5px 10px;
    border: 2px solid #e9ecef;
    border-radius: 6px;
    background: white;
}

.paginacja-przyciski {
    display: flex;
    align-items: center;
    gap: 5px;
}

.btn-paginacja {
    width: 40px;
    height: 40px;
    border: 2px solid #e9ecef;
    background: white;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6c757d;
}

.btn-paginacja:hover:not(:disabled) {
    background: #667eea;
    border-color: #667eea;
    color: white;
    transform: translateY(-1px);
}

.btn-paginacja:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* Modal */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    padding: 20px;
    box-sizing: border-box;
}

.modal-kontener {
    background: white;
    border-radius: 16px;
    box-shadow: 0 25px 50px rgba(0,0,0,0.2);
    max-width: 600px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
}

.modal-naglowek {
    padding: 25px 30px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-radius: 16px 16px 0 0;
}

.modal-naglowek h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 10px;
}

.btn-zamknij-modal {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.btn-zamknij-modal:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

.modal-tresc {
    padding: 30px;
}

.modal-siatka {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

.grupa-pola.pe≈Çna-szeroko≈õƒá {
    grid-column: 1 / -1;
}

.modal-stopka {
    padding: 20px 30px;
    border-top: 2px solid #f8f9fa;
    display: flex;
    justify-content: flex-end;
    gap: 15px;
}

.btn-g≈Ç√≥wny,
.btn-drugorzedny {
    padding: 12px 24px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    border: none;
}

.btn-g≈Ç√≥wny {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.btn-g≈Ç√≥wny:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
}

.btn-drugorzedny {
    background: #f8f9fa;
    color: #6c757d;
    border: 2px solid #e9ecef;
}

.btn-drugorzedny:hover {
    background: #e9ecef;
    transform: translateY(-1px);
}

/* Responsywno≈õƒá */
@media (max-width: 768px) {
    .obecnosc-komponent {
        padding: 10px;
    }
    
    .naglowek-obecnosci {
        padding: 25px 20px;
    }
    
    .naglowek-obecnosci h1 {
        font-size: 1.8rem;
        flex-direction: column;
        gap: 10px;
    }
    
    .panel-kontroli {
        padding: 20px;
    }
    
    .filtry-siatka {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .akcje-filtrow {
        flex-direction: column;
    }
    
    .panel-statystyk {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .tabela-naglowek {
        padding: 20px;
        flex-direction: column;
        align-items: stretch;
    }
    
    .tabela-akcje {
        justify-content: flex-end;
    }
    
    .paginacja-kontener {
        flex-direction: column;
        gap: 15px;
        padding: 20px;
    }
    
    .modal-overlay {
        padding: 10px;
    }
    
    .modal-tresc {
        padding: 20px;
    }
    
    .modal-siatka {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 480px) {
    .statystyka-karta {
        flex-direction: column;
        text-align: center;
        gap: 15px;
    }
    
    .btn-filtruj,
    .btn-wyczysc,
    .btn-eksport {
        width: 100%;
        justify-content: center;
    }
}
</style>

<script>
// KLASA KOMPONENTU EWIDENCJI OBECNO≈öCI
class ObecnoscKomponent {
    constructor() {
        this.obecnaDane = [];
        this.filtrowaneData = [];
        this.obecnaStrona = 1;
        this.wynikowNaStrone = 25;
        this.calkowitaLiczbaStron = 1;
        this.aktualnyFiltr = {};
        this.init();
    }

    init() {
        // Auto-inicjalizacja gdy DOM jest gotowy
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                this.inicjalizujKomponent();
            });
        } else {
            this.inicjalizujKomponent();
        }
    }

    inicjalizujKomponent() {
        this.konfigurujObslugeDatek();
        this.ladujPoczatkowe();
        this.konfigurujObslugeFormularza();
        
        console.log('‚úÖ Komponent ewidencji obecno≈õci zosta≈Ç zainicjalizowany');
    }

    konfigurujObslugeDatek() {
        // Ustawienie domy≈õlnych dat
        const dzis = new Date();
        const miesiacTemu = new Date();
        miesiacTemu.setMonth(dzis.getMonth() - 1);
        
        document.getElementById('filtr-data-od').value = this.formatujDate(miesiacTemu);
        document.getElementById('filtr-data-do').value = this.formatujDate(dzis);
        
        // Obs≈Çuga przycisk√≥w
        document.getElementById('zastosuj-filtry').addEventListener('click', () => {
            this.zastosujFiltry();
        });
        
        document.getElementById('wyczysc-filtry').addEventListener('click', () => {
            this.wyczyscFiltry();
        });
        
        document.getElementById('eksport-danych').addEventListener('click', () => {
            this.eksportujDane();
        });
        
        document.getElementById('odswiez-tabele').addEventListener('click', () => {
            this.odswiezDane();
        });
        
        document.getElementById('dodaj-wpis').addEventListener('click', () => {
            this.otworzModalDodawania();
        });
        
        // Obs≈Çuga paginacji
        document.getElementById('wynikow-na-strone').addEventListener('change', (e) => {
            this.wynikowNaStrone = parseInt(e.target.value);
            this.obecnaStrona = 1;
            this.aktualizujTabele();
        });
    }

    konfigurujObslugeFormularza() {
        // Modal
        document.getElementById('zamknij-modal').addEventListener('click', () => {
            this.zamknijModal();
        });
        
        document.getElementById('anuluj-modal').addEventListener('click', () => {
            this.zamknijModal();
        });
        
        document.getElementById('zapisz-wpis').addEventListener('click', () => {
            this.zapiszWpis();
        });
        
        // Zamkniƒôcie modala po klikniƒôciu w overlay
        document.getElementById('modal-wpisu').addEventListener('click', (e) => {
            if (e.target.id === 'modal-wpisu') {
                this.zamknijModal();
            }
        });
    }

    async ladujPoczatkowe() {
        try {
            await this.ladujDaneObecnosci();
            await this.ladujListePracownikow();
            this.aktualizujStatystyki();
            this.aktualizujTabele();
        } catch (blad) {
            console.error('‚ùå B≈ÇƒÖd podczas ≈Çadowania danych:', blad);
            this.pokazKomunikatBledu('B≈ÇƒÖd podczas ≈Çadowania danych obecno≈õci');
        }
    }

    async ladujDaneObecnosci() {
        // Symulacja ≈Çadowania danych z API
        // W prawdziwej aplikacji: const response = await fetch('/api/obecnosc');
        
        await new Promise(resolve => setTimeout(resolve, 1500));
        
        // Przyk≈Çadowe dane
        this.obecnaDane = [
            {
                id: 1,
                pracownik: 'Jan Kowalski',
                dzial: 'it',
                data: '2025-08-08',
                rozpoczecie: '08:00',
                zakonczenie: '16:00',
                czasPracy: '8:00',
                status: 'obecny',
                uwagi: ''
            },
            {
                id: 2,
                pracownik: 'Anna Nowak',
                dzial: 'marketing',
                data: '2025-08-08',
                rozpoczecie: '08:30',
                zakonczenie: '16:30',
                czasPracy: '8:00',
                status: 'spoznienie',
                uwagi: 'Sp√≥≈∫nienie 30 min - komunikacja miejska'
            },
            {
                id: 3,
                pracownik: 'Piotr Wi≈õniewski',
                dzial: 'hr',
                data: '2025-08-08',
                rozpoczecie: '',
                zakonczenie: '',
                czasPracy: '0:00',
                status: 'urlop',
                uwagi: 'Urlop wypoczynkowy'
            },
            // Wiƒôcej przyk≈Çadowych danych...
        ];
        
        this.filtrowaneData = [...this.obecnaDane];
        console.log(`‚úÖ Za≈Çadowano ${this.obecnaDane.length} rekord√≥w obecno≈õci`);
    }

    async ladujListePracownikow() {
        // Symulacja ≈Çadowania listy pracownik√≥w
        const pracownicy = [
            { id: 1, nazwa: 'Jan Kowalski' },
            { id: 2, nazwa: 'Anna Nowak' },
            { id: 3, nazwa: 'Piotr Wi≈õniewski' },
            { id: 4, nazwa: 'Maria Kowalczyk' },
            { id: 5, nazwa: 'Tomasz Zieli≈Ñski' }
        ];
        
        const selectPracownik = document.getElementById('modal-pracownik');
        selectPracownik.innerHTML = '<option value="">-- Wybierz pracownika --</option>';
        
        pracownicy.forEach(pracownik => {
            const opcja = document.createElement('option');
            opcja.value = pracownik.id;
            opcja.textContent = pracownik.nazwa;
            selectPracownik.appendChild(opcja);
        });
    }

    zastosujFiltry() {
        const dataOd = document.getElementById('filtr-data-od').value;
        const dataDo = document.getElementById('filtr-data-do').value;
        const dzial = document.getElementById('filtr-dzial').value;
        const status = document.getElementById('filtr-status').value;
        
        this.aktualnyFiltr = { dataOd, dataDo, dzial, status };
        
        this.filtrowaneData = this.obecnaDane.filter(rekord => {
            let pasuje = true;
            
            if (dataOd && rekord.data < dataOd) pasuje = false;
            if (dataDo && rekord.data > dataDo) pasuje = false;
            if (dzial && rekord.dzial !== dzial) pasuje = false;
            if (status && rekord.status !== status) pasuje = false;
            
            return pasuje;
        });
        
        this.obecnaStrona = 1;
        this.aktualizujStatystyki();
        this.aktualizujTabele();
        
        console.log(`üîç Filtrowanie: znaleziono ${this.filtrowaneData.length} rekord√≥w`);
    }

    wyczyscFiltry() {
        document.getElementById('filtr-data-od').value = '';
        document.getElementById('filtr-data-do').value = '';
        document.getElementById('filtr-dzial').value = '';
        document.getElementById('filtr-status').value = '';
        
        this.aktualnyFiltr = {};
        this.filtrowaneData = [...this.obecnaDane];
        this.obecnaStrona = 1;
        this.aktualizujStatystyki();
        this.aktualizujTabele();
        
        console.log('üßπ Filtry wyczyszczone');
    }

    aktualizujStatystyki() {
        const statystyki = this.obliczStatystyki();
        
        document.getElementById('liczba-obecnych').textContent = statystyki.obecni;
        document.getElementById('liczba-nieobecnych').textContent = statystyki.nieobecni;
        document.getElementById('liczba-spoznien').textContent = statystyki.spoznienia;
        document.getElementById('liczba-urlopow').textContent = statystyki.urlopy;
    }

    obliczStatystyki() {
        return {
            obecni: this.filtrowaneData.filter(r => r.status === 'obecny').length,
            nieobecni: this.filtrowaneData.filter(r => r.status === 'nieobecny').length,
            spoznienia: this.filtrowaneData.filter(r => r.status === 'spoznienie').length,
            urlopy: this.filtrowaneData.filter(r => r.status === 'urlop').length
        };
    }

    aktualizujTabele() {
        const tbody = document.getElementById('tabela-obecnosci-body');
        const startIndex = (this.obecnaStrona - 1) * this.wynikowNaStrone;
        const endIndex = startIndex + this.wynikowNaStrone;
        const daneDoWyswietlenia = this.filtrowaneData.slice(startIndex, endIndex);
        
        if (daneDoWyswietlenia.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="10" style="text-align: center; padding: 40px; color: #6c757d;">
                        <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: 20px; display: block;"></i>
                        Brak danych do wy≈õwietlenia
                    </td>
                </tr>
            `;
        } else {
            tbody.innerHTML = daneDoWyswietlenia.map(rekord => `
                <tr>
                    <td>${rekord.id}</td>
                    <td><strong>${rekord.pracownik}</strong></td>
                    <td>${this.pobierzNazweDzialu(rekord.dzial)}</td>
                    <td>${this.formatujDatePolski(rekord.data)}</td>
                    <td>${rekord.rozpoczecie || '-'}</td>
                    <td>${rekord.zakonczenie || '-'}</td>
                    <td>${rekord.czasPracy || '-'}</td>
                    <td><span class="status-badge status-${rekord.status}">${this.pobierzNazweStatusu(rekord.status)}</span></td>
                    <td>${rekord.uwagi || '-'}</td>
                    <td>
                        <button class="btn-edytuj" onclick="ObecnoscApp.edytujWpis(${rekord.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-usun" onclick="ObecnoscApp.usunWpis(${rekord.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }
        
        this.aktualizujPaginacje();
    }

    aktualizujPaginacje() {
        this.calkowitaLiczbaStron = Math.ceil(this.filtrowaneData.length / this.wynikowNaStrone);
        
        const info = document.getElementById('paginacja-info-tekst');
        const startIndex = (this.obecnaStrona - 1) * this.wynikowNaStrone + 1;
        const endIndex = Math.min(this.obecnaStrona * this.wynikowNaStrone, this.filtrowaneData.length);
        
        info.textContent = `Pokazano ${startIndex}-${endIndex} z ${this.filtrowaneData.length} wynik√≥w`;
        
        // Aktualizuj przyciski paginacji
        document.getElementById('pierwsza-strona').disabled = this.obecnaStrona === 1;
        document.getElementById('poprzednia-strona').disabled = this.obecnaStrona === 1;
        document.getElementById('nastepna-strona').disabled = this.obecnaStrona === this.calkowitaLiczbaStron || this.calkowitaLiczbaStron === 0;
        document.getElementById('ostatnia-strona').disabled = this.obecnaStrona === this.calkowitaLiczbaStron || this.calkowitaLiczbaStron === 0;
    }

    async odswiezDane() {
        document.getElementById('odswiez-tabele').innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> Od≈õwie≈ºanie...';
        
        try {
            await this.ladujDaneObecnosci();
            this.zastosujFiltry(); // Ponownie zastosuj filtry
            
            setTimeout(() => {
                document.getElementById('odswiez-tabele').innerHTML = '<i class="fas fa-sync-alt"></i> Od≈õwie≈º';
            }, 1000);
            
            console.log('‚úÖ Dane zosta≈Çy od≈õwie≈ºone');
        } catch (blad) {
            console.error('‚ùå B≈ÇƒÖd podczas od≈õwie≈ºania:', blad);
            this.pokazKomunikatBledu('B≈ÇƒÖd podczas od≈õwie≈ºania danych');
        }
    }

    otworzModalDodawania() {
        document.getElementById('modal-tytul').textContent = 'Dodaj Wpis Obecno≈õci';
        document.getElementById('modal-data').value = this.formatujDate(new Date());
        document.getElementById('modal-wpisu').style.display = 'flex';
    }

    zamknijModal() {
        document.getElementById('modal-wpisu').style.display = 'none';
        document.getElementById('formularz-wpisu').reset();
    }

    async zapiszWpis() {
        const formularz = document.getElementById('formularz-wpisu');
        const daneFormularza = new FormData(formularz);
        
        // Walidacja
        if (!daneFormularza.get('pracownik') || !daneFormularza.get('data') || !daneFormularza.get('status')) {
            this.pokazKomunikatBledu('Wype≈Çnij wszystkie wymagane pola');
            return;
        }
        
        // Symulacja zapisu
        try {
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            this.zamknijModal();
            this.pokazKomunikatSukcesu('Wpis zosta≈Ç pomy≈õlnie zapisany');
            await this.odswiezDane();
            
        } catch (blad) {
            console.error('‚ùå B≈ÇƒÖd podczas zapisywania:', blad);
            this.pokazKomunikatBledu('B≈ÇƒÖd podczas zapisywania wpisu');
        }
    }

    eksportujDane() {
        const dane = this.filtrowaneData.map(rekord => ({
            ID: rekord.id,
            Pracownik: rekord.pracownik,
            Dzial: this.pobierzNazweDzialu(rekord.dzial),
            Data: rekord.data,
            Rozpoczecie: rekord.rozpoczecie || '',
            Zakonczenie: rekord.zakonczenie || '',
            'Czas Pracy': rekord.czasPracy || '',
            Status: this.pobierzNazweStatusu(rekord.status),
            Uwagi: rekord.uwagi || ''
        }));
        
        this.eksportujDoCSV(dane, 'ewidencja_obecnosci.csv');
    }

    eksportujDoCSV(dane, nazwaPlik) {
        const csv = this.konwertujDoCSV(dane);
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        
        if (link.download !== undefined) {
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', nazwaPlik);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        console.log(`üì• Eksport danych do pliku: ${nazwaPlik}`);
    }

    konwertujDoCSV(dane) {
        if (!dane.length) return '';
        
        const naglowki = Object.keys(dane[0]);
        const csvContent = [
            naglowki.join(','),
            ...dane.map(wiersz =>
                naglowki.map(pole =>
                    `"${String(wiersz[pole]).replace(/"/g, '""')}"`
                ).join(',')
            )
        ].join('\n');
        
        return '\uFEFF' + csvContent; // BOM dla UTF-8
    }

    // Funkcje pomocnicze
    formatujDate(data) {
        return data.toISOString().split('T')[0];
    }

    formatujDatePolski(dataString) {
        if (!dataString) return '';
        const data = new Date(dataString);
        return data.toLocaleDateString('pl-PL');
    }

    pobierzNazweDzialu(wartosc) {
        const dzialy = {
            'administracja': 'üè¢ Administracja',
            'it': 'üíª IT',
            'marketing': 'üìà Marketing',
            'hr': 'üë• HR',
            'finanse': 'üí∞ Finanse',
            'produkcja': 'üè≠ Produkcja',
            'logistyka': 'üöö Logistyka'
        };
        return dzialy[wartosc] || wartosc || 'Nieznany';
    }

    pobierzNazweStatusu(wartosc) {
        const statusy = {
            'obecny': 'üü¢ Obecny',
            'nieobecny': 'üî¥ Nieobecny',
            'spoznienie': 'üü° Sp√≥≈∫nienie',
            'urlop': 'üèñÔ∏è Urlop',
            'choroba': 'üè• L4',
            'delegacja': '‚úàÔ∏è Delegacja'
        };
        return statusy[wartosc] || wartosc || 'Nieznany';
    }

    pokazKomunikatSukcesu(wiadomosc) {
        // Implementacja wy≈õwietlania komunikatu sukcesu
        console.log('‚úÖ Sukces:', wiadomosc);
        // Tu mo≈ºna dodaƒá toast notification
    }

    pokazKomunikatBledu(wiadomosc) {
        // Implementacja wy≈õwietlania komunikatu b≈Çƒôdu
        console.error('‚ùå B≈ÇƒÖd:', wiadomosc);
        // Tu mo≈ºna dodaƒá toast notification
    }

    // Metody publiczne dla przycisk√≥w w tabeli
    edytujWpis(id) {
        const rekord = this.obecnaDane.find(r => r.id === id);
        if (rekord) {
            // Wype≈Çnij formularz danymi do edycji
            document.getElementById('modal-tytul').textContent = 'Edytuj Wpis Obecno≈õci';
            document.getElementById('modal-pracownik').value = rekord.pracownik;
            document.getElementById('modal-data').value = rekord.data;
            document.getElementById('modal-rozpoczecie').value = rekord.rozpoczecie;
            document.getElementById('modal-zakonczenie').value = rekord.zakonczenie;
            document.getElementById('modal-status').value = rekord.status;
            document.getElementById('modal-uwagi').value = rekord.uwagi;
            document.getElementById('modal-wpisu').style.display = 'flex';
        }
    }

    async usunWpis(id) {
        if (confirm('Czy na pewno chcesz usunƒÖƒá ten wpis?')) {
            try {
                // Symulacja usuniƒôcia
                await new Promise(resolve => setTimeout(resolve, 500));
                this.pokazKomunikatSukcesu('Wpis zosta≈Ç usuniƒôty');
                await this.odswiezDane();
            } catch (blad) {
                this.pokazKomunikatBledu('B≈ÇƒÖd podczas usuwania wpisu');
            }
        }
    }
}

// Inicjalizacja globalnego obiektu
window.ObecnoscApp = new ObecnoscKomponent();
</script>
